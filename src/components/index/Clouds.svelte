<script>
  export let innerWidth = 900;
  import { onMount } from "svelte";
  import { tweened } from "svelte/motion";
  import { cubicOut } from "svelte/easing";
  import { fade } from "svelte/transition";
  export let lightMode = false;

  let transform = `scale(${
    (100 / innerWidth) * 10 < 1 ? 1 : (100 / innerWidth) * 10
  })`;

  $: moonHeight = `${0.12 * innerWidth}px`;

  const cloudPos = tweened(0, {
    duration: 3000,
    easing: cubicOut,
  });

  const cloudPosAlt = tweened(0, {
    duration: 3000,
    easing: cubicOut,
  });

  let position = 0;
  let positionAlt = 0;

  onMount(() => {
    window.requestAnimationFrame(changeCloudPosition);
  });

  function moveCloud(marker, threshhold, cloudPosition, zeroReset = false) {
    if (marker > innerWidth * threshhold) {
      marker = zeroReset ? 0 : -marker * threshhold;
      cloudPosition.set(marker, {
        duration: 0,
      });
    } else {
      cloudPosition.set(marker);
    }

    return marker;
  }

  const CLOUD_VELOCITY = 5;

  function changeCloudPosition() {
    position += CLOUD_VELOCITY;
    positionAlt += CLOUD_VELOCITY;

    position = moveCloud(position, 1.2, cloudPos);
    positionAlt = moveCloud(positionAlt, 2.7, cloudPosAlt, true);

    setTimeout(() => {
      window.requestAnimationFrame(changeCloudPosition);
    }, 500);
  }
</script>

<style lang="scss">
  $transform: var(--transform);
  $moonSize: var(--moonSize);
  div {
    position: absolute;
    left: 0px;
    right: 0px;
    top: 10%;
    height: 40%;
    div#clouds {
      > .container {
        position: absolute;
        height: 100%;
        width: 100%;
      }
      transform: $transform;
      g g path {
        transform: translate(100, 0);
      }
    }
    div#moon {
      position: absolute;
      z-index: -1;
      top: 5%;
      left: 10%;
      height: $moonSize;
      width: $moonSize;
      -webkit-box-shadow: -1px 3px 59px 1px rgba(214, 217, 126, 0.68);
      -moz-box-shadow: -1px 3px 59px 1px rgba(214, 217, 126, 0.68);
      box-shadow: -1px 3px 59px 1px rgba(214, 217, 126, 0.68);
      background-color: #f9b7e7;
      border-radius: 999px;
    }
  }
</style>

<div style="--transform:{transform}; --moonSize:{moonHeight}">
  <div id="clouds">
    <svg
      xmlns="http://www.w3.org/2000/svg"
      viewBox="80 80 1900 250.6"
      class="container">
      <path
        d="M51.1 203.2c-14.6-28.7 18.6-58.6 48.7-69.8a295.5 295.5 0
        01129-17.4c27.4 2.5 55.1 8.7 82 3.2 18-3.7 34.6-12.5 51.5-19.9A302.7
        302.7 0 01541 78.2c50.3 10 99 34.5 150 30.1 30.4-2.6 59-15.3
        88-24.3a380.3 380.3 0 01164-13.6c13.5 1.8 27.7 4.2 40-1.2 13.7-6
        21.7-19.9 31.8-30.8 32.4-35 85.9-38 133.7-38.4 16.8-.2 36.6 1.1 46 15.2
        4.2 6.5 5.3 14.6 9.2 21.4 12.9 22.8 46.2 19 71.7 12.9a1515.6 1515.6 0
        01399.8-42.3c54.1 1.5 108.4 6 161.2 18 66.9 15.2 136.2 42.6 201.8
        22.4L2047 87l-108.4 23.2c-28.6 6.1-60.1 14.1-76.3 38.5-10 15-12.4
        34-21.3 49.8-25.3 45-88.3 46.2-139.6
        41.7l-350.9-30.6c-50.7-4.4-102.2-8.8-152.3.7-39.1 7.4-76.3 23-115.1
        31.7-67.9 15-138.7 8.3-207.2-3.3-48.6-8.3-97.4-19-146.7-17.2-45 1.6-88.9
        13.7-131.8 27.2C397 311.4 206.2 406.3 0 445.6 41.2 416 98.7 420 142
        393.9c28.9-17.4 48.5-46.3 72.4-70 102-101.3 265-97.8 399.4-148.9-58.5
        6.4-118.8-6.6-175.7 8-29.2 7.6-56 22-83.3 35a840.4 840.4 0 01-340.7
        80.4l24.6-95.1"
        fill={lightMode === true ? `#d6fff7` : `#c63090`}
        opacity=".3"
        data-name="Layer 2" />
    </svg>
    <!-- First Set of Clouds -->
    <svg
      xmlns="http://www.w3.org/2000/svg"
      viewBox="{$cloudPos} 0 1740.72 182.02"
      class="container">
      <defs>
        <style>
          .class-2 {
            fill: #c63090;
          }
          .class-2-alt {
            fill: #f5fafa;
          }
          .class-3 {
            fill: #140205;
            opacity: 0.29;
          }
          .class-3-alt {
            fill: #ffa61f;
            opacity: 0.29;
          }
        </style>
      </defs>
      <g id="Layer_2" data-name="Layer 2">
        <g id="Clouds" transform="translate(0, 0)">
          <path
            class={lightMode === true ? `class-2-alt` : `class-2`}
            d="M333.53 115.48l-.38.07-56.41 10.63c-5.66 1.06-11.54 2.23-16.13
              5.71-3.35 2.55-5.76 6.17-9.16 8.66-13.06
              9.58-30.49-1.67-45.43-7.94-35.42-14.87-83.26-2.06-108.56-31-8.45
              2.93-3 17.48-9.37 23.77-2.43 2.4-6.08 3-9.48 3.32a122.27 122.27 0
              01-59.9-9.44l-1.16 4.89C8.61 121.53 2 113.19.39 104.09A23.05 23.05 0
              011 93.21C4.83 80.76 19.75 73 32.15 77c2.74.89 5.55 2.27 8.35 1.6
              4.06-1 5.86-5.55 7.67-9.31A40.15 40.15 0 0179 47.26c5.83-.69
              12.86-.62 16-5.57 2.08-3.23 1.57-7.44 2.6-11.14 3.89-14.08
              24.51-12.72 37.74-6.53 4.05 1.9 8.71 5.27 7.78 9.65-1.12 5.53-9.37
              5.58-13.12 9.83-6.1 7 4.46 16.93 13.69 17.73s20.37-.88 26.1
              6.42c4.46 5.68 3 13.79 3.92 20.95 2.31 17.06 22.51 29.12 38.62 23.06
              5.13-1.93 9.63-5.29 14.81-7.07 19.66-6.78 39.33 10.71 60.07
              12.18a24.19 24.19 0 0146.29-1.29zM298.86 31.62c9.85-3.87 13.57-18.84
              24.15-19.36 7-.34 13 6.39 20 5.75 6.11-.55 10.13-6.33
              14.73-10.39a31.25 31.25 0 0129.89-6.14C393 3.27 398.52 9.79 394.68
              14a28.51 28.51 0 0116.57 8.79c-9.66 8.82-26.88-4.71-37.76 2.55-2.06
              1.37-3.62 3.37-5.54 4.94-5.82 4.76-14.27 5-21.5
              2.89s-13.74-6.09-20.6-9.17c-3.44-1.54-7.25-2.87-10.91-2-7.73
              1.84-12.27 12.76-20.1 11.45M1571.76 48c14.81-5.83 20.41-28.33
              36.3-29.11 10.54-.51 19.54 9.6 30 8.64 9.18-.83 15.23-9.51
              22.14-15.62a47 47 0 0144.93-9.23c8.17 2.69 16.41 12.49 10.63
              18.86a42.9 42.9 0 0124.91 13.22c-14.53 13.26-40.4-7.08-56.77
              3.83-3.09 2.07-5.44 5.07-8.32 7.42-8.76 7.16-21.46 7.46-32.33
              4.35s-20.64-9.15-31-13.78c-5.16-2.31-10.88-4.31-16.39-3-11.62
              2.78-18.44 19.18-30.22 17.22M1057.58 72.57a10.65 10.65 0 01-4.24
              8.88c-2.77 2-6.29 2.51-9.67 2.9a210.08 210.08 0
              01-77.86-5.76c-6.91-1.85-13.82-4.07-21-4.38-7.42-.32-14.76
              1.44-22.06 2.84a228.6 228.6 0 01-73 2l1.56-5.39a84.35 84.35 0
              013.57-9.76 86.81 86.81 0 0126.54-34c3.25-2.49 6.89-4.83
              11-5.08s8.61 2.3 9.19 6.35A42.92 42.92 0 01971.38 23c9.14 10.25
              13.89 25.27 26.38 31 8.14 3.74 17.58 2.45 26.48 1.42s18.6-1.55 26.09
              3.37a17 17 0 017.25 13.78zM1445 163.85l-16.83 3.2-25.8 4.91-40.65
              7.73c-14.28 2.71-31.08
              4.73-41.49-5.42-2.94-2.86-5.31-6.66-9.19-8-7.13-2.43-13.51
              4.64-19.88 8.67-7.36 4.66-16.45 5.45-25.15 5.94a687.86 687.86 0
              01-197.22-17.31l-.37 4.8a22.16 22.16 0 01-9.49-13c-3.28-11.52 1-26
              11.13-33.33 14.78-10.68 36.05-8 51.51 1.68 6.14 3.84 16.05 7.71
              18.91 1.05 1.52-3.52-.69-7.4-1.92-11-4-11.79 3.88-25.8
              15.71-29.68s25.69 1.82 32.52 12.23c9-4.06-1.57-21.27 6.57-26.83
              1.94-1.33 4.43-1.47 6.78-1.56 18.39-.72 38.54-.9 53 10.55s15.69
              39.13-1.66 45.28a37.44 37.44 0 0034.16 16.4c12.77-1.21 24.74-9.07
              37.48-7.59 13.6 1.59 23.48 13.13 34.9 20.68 22 14.54 49.89 14.2
              76.54 11.69 3.5-.34 7-.71 10.44-1.09z" />
          <path
            class={lightMode === true ? `class-3-alt` : `class-3`}
            d="M333.15 115.55l-56.41 10.63c-5.66 1.06-11.54 2.23-16.13 5.71-3.35
              2.55-5.76 6.17-9.16 8.66-13.06
              9.58-30.49-1.67-45.43-7.94-35.42-14.87-83.26-2.06-108.56-31-8.45
              2.93-3 17.48-9.37 23.77-2.43 2.4-6.08 3-9.48 3.32a122.27 122.27 0
              01-59.9-9.44l-1.16 4.89C8.61 121.53 2 113.19.39 104.09c8.63 3.13
              21.07 6.27 30 2.71 15-6 20-22 36-21s15-18 45 4 34 21 62 25 28 10 53
              12 54-10 71-9 25.85-13.8 35.76-2.25zM1057.58 72.57a10.65 10.65 0
              01-4.24 8.88c-2.77 2-6.29 2.51-9.67 2.9a210.08 210.08 0
              01-77.86-5.76c-6.91-1.85-13.82-4.07-21-4.38-7.42-.32-14.76
              1.44-22.06 2.84a228.6 228.6 0 01-73 2l1.56-5.39a84.35 84.35 0
              013.57-9.76c5.7-1.92 12-3 17.19-1.43 13 4 32 11 38-1s16-26 36-14 76
              35 89 30c9.22-3.53 17.44-7.08 22.51-4.9zM1402.39 172l-40.65
              7.73c-14.28 2.71-31.08
              4.73-41.49-5.42-2.94-2.86-5.31-6.66-9.19-8-7.13-2.43-13.51
              4.64-19.88 8.67-7.36 4.66-16.45 5.45-25.15 5.94a687.86 687.86 0
              01-197.22-17.31l-.37 4.8a22.16 22.16 0 01-9.49-13 45 45 0
              0129.72-7.72c23.4 1.82 80.39 17.12 79.9 7s8.5-29.15 17.5-14.15 2 15
              19 7 37 0 44 7 14.06 4.34 36 2.67 46-16.67 53-2.67c4.93 9.78 32.01
              20.1 64.32 17.46z" />
        </g>
      </g>
    </svg>
    <!-- Second Set of Clouds -->
    <svg
      xmlns="http://www.w3.org/2000/svg"
      viewBox="{$cloudPosAlt - innerWidth * 1.5} 0 1740.72 182.02"
      class="container">
      <defs>
        <style>
          .class-2 {
            fill: #c63090;
          }
          .class-2-alt {
            fill: #f5fafa;
          }
          .class-3 {
            fill: #140205;
            opacity: 0.29;
          }
          .class-3-alt {
            fill: #ffa61f;
            opacity: 0.29;
          }
        </style>
      </defs>
      <g id="Layer_2" data-name="Layer 2">
        <g id="Clouds" transform="translate(0, 0)">
          <path
            class={lightMode === true ? `class-2-alt` : `class-2`}
            d="M333.53 115.48l-.38.07-56.41 10.63c-5.66 1.06-11.54 2.23-16.13
              5.71-3.35 2.55-5.76 6.17-9.16 8.66-13.06
              9.58-30.49-1.67-45.43-7.94-35.42-14.87-83.26-2.06-108.56-31-8.45
              2.93-3 17.48-9.37 23.77-2.43 2.4-6.08 3-9.48 3.32a122.27 122.27 0
              01-59.9-9.44l-1.16 4.89C8.61 121.53 2 113.19.39 104.09A23.05 23.05 0
              011 93.21C4.83 80.76 19.75 73 32.15 77c2.74.89 5.55 2.27 8.35 1.6
              4.06-1 5.86-5.55 7.67-9.31A40.15 40.15 0 0179 47.26c5.83-.69
              12.86-.62 16-5.57 2.08-3.23 1.57-7.44 2.6-11.14 3.89-14.08
              24.51-12.72 37.74-6.53 4.05 1.9 8.71 5.27 7.78 9.65-1.12 5.53-9.37
              5.58-13.12 9.83-6.1 7 4.46 16.93 13.69 17.73s20.37-.88 26.1
              6.42c4.46 5.68 3 13.79 3.92 20.95 2.31 17.06 22.51 29.12 38.62 23.06
              5.13-1.93 9.63-5.29 14.81-7.07 19.66-6.78 39.33 10.71 60.07
              12.18a24.19 24.19 0 0146.29-1.29zM298.86 31.62c9.85-3.87 13.57-18.84
              24.15-19.36 7-.34 13 6.39 20 5.75 6.11-.55 10.13-6.33
              14.73-10.39a31.25 31.25 0 0129.89-6.14C393 3.27 398.52 9.79 394.68
              14a28.51 28.51 0 0116.57 8.79c-9.66 8.82-26.88-4.71-37.76 2.55-2.06
              1.37-3.62 3.37-5.54 4.94-5.82 4.76-14.27 5-21.5
              2.89s-13.74-6.09-20.6-9.17c-3.44-1.54-7.25-2.87-10.91-2-7.73
              1.84-12.27 12.76-20.1 11.45M1571.76 48c14.81-5.83 20.41-28.33
              36.3-29.11 10.54-.51 19.54 9.6 30 8.64 9.18-.83 15.23-9.51
              22.14-15.62a47 47 0 0144.93-9.23c8.17 2.69 16.41 12.49 10.63
              18.86a42.9 42.9 0 0124.91 13.22c-14.53 13.26-40.4-7.08-56.77
              3.83-3.09 2.07-5.44 5.07-8.32 7.42-8.76 7.16-21.46 7.46-32.33
              4.35s-20.64-9.15-31-13.78c-5.16-2.31-10.88-4.31-16.39-3-11.62
              2.78-18.44 19.18-30.22 17.22M1057.58 72.57a10.65 10.65 0 01-4.24
              8.88c-2.77 2-6.29 2.51-9.67 2.9a210.08 210.08 0
              01-77.86-5.76c-6.91-1.85-13.82-4.07-21-4.38-7.42-.32-14.76
              1.44-22.06 2.84a228.6 228.6 0 01-73 2l1.56-5.39a84.35 84.35 0
              013.57-9.76 86.81 86.81 0 0126.54-34c3.25-2.49 6.89-4.83
              11-5.08s8.61 2.3 9.19 6.35A42.92 42.92 0 01971.38 23c9.14 10.25
              13.89 25.27 26.38 31 8.14 3.74 17.58 2.45 26.48 1.42s18.6-1.55 26.09
              3.37a17 17 0 017.25 13.78zM1445 163.85l-16.83 3.2-25.8 4.91-40.65
              7.73c-14.28 2.71-31.08
              4.73-41.49-5.42-2.94-2.86-5.31-6.66-9.19-8-7.13-2.43-13.51
              4.64-19.88 8.67-7.36 4.66-16.45 5.45-25.15 5.94a687.86 687.86 0
              01-197.22-17.31l-.37 4.8a22.16 22.16 0 01-9.49-13c-3.28-11.52 1-26
              11.13-33.33 14.78-10.68 36.05-8 51.51 1.68 6.14 3.84 16.05 7.71
              18.91 1.05 1.52-3.52-.69-7.4-1.92-11-4-11.79 3.88-25.8
              15.71-29.68s25.69 1.82 32.52 12.23c9-4.06-1.57-21.27 6.57-26.83
              1.94-1.33 4.43-1.47 6.78-1.56 18.39-.72 38.54-.9 53 10.55s15.69
              39.13-1.66 45.28a37.44 37.44 0 0034.16 16.4c12.77-1.21 24.74-9.07
              37.48-7.59 13.6 1.59 23.48 13.13 34.9 20.68 22 14.54 49.89 14.2
              76.54 11.69 3.5-.34 7-.71 10.44-1.09z" />
          <path
            class={lightMode === true ? `class-3-alt` : `class-3`}
            d="M333.15 115.55l-56.41 10.63c-5.66 1.06-11.54 2.23-16.13 5.71-3.35
              2.55-5.76 6.17-9.16 8.66-13.06
              9.58-30.49-1.67-45.43-7.94-35.42-14.87-83.26-2.06-108.56-31-8.45
              2.93-3 17.48-9.37 23.77-2.43 2.4-6.08 3-9.48 3.32a122.27 122.27 0
              01-59.9-9.44l-1.16 4.89C8.61 121.53 2 113.19.39 104.09c8.63 3.13
              21.07 6.27 30 2.71 15-6 20-22 36-21s15-18 45 4 34 21 62 25 28 10 53
              12 54-10 71-9 25.85-13.8 35.76-2.25zM1057.58 72.57a10.65 10.65 0
              01-4.24 8.88c-2.77 2-6.29 2.51-9.67 2.9a210.08 210.08 0
              01-77.86-5.76c-6.91-1.85-13.82-4.07-21-4.38-7.42-.32-14.76
              1.44-22.06 2.84a228.6 228.6 0 01-73 2l1.56-5.39a84.35 84.35 0
              013.57-9.76c5.7-1.92 12-3 17.19-1.43 13 4 32 11 38-1s16-26 36-14 76
              35 89 30c9.22-3.53 17.44-7.08 22.51-4.9zM1402.39 172l-40.65
              7.73c-14.28 2.71-31.08
              4.73-41.49-5.42-2.94-2.86-5.31-6.66-9.19-8-7.13-2.43-13.51
              4.64-19.88 8.67-7.36 4.66-16.45 5.45-25.15 5.94a687.86 687.86 0
              01-197.22-17.31l-.37 4.8a22.16 22.16 0 01-9.49-13 45 45 0
              0129.72-7.72c23.4 1.82 80.39 17.12 79.9 7s8.5-29.15 17.5-14.15 2 15
              19 7 37 0 44 7 14.06 4.34 36 2.67 46-16.67 53-2.67c4.93 9.78 32.01
              20.1 64.32 17.46z" />
        </g>
      </g>
    </svg>
  </div>
  {#if lightMode === false}
    <div in:fade id="moon" />
  {/if}
</div>
